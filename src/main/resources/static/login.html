<!DOCTYPE html>
<html lang="en">

<head>
   <!-- basic -->
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <!-- mobile metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="initial-scale=1, maximum-scale=1">
   <!-- site metas -->
   <title>QUVA IT CENTER</title>
   <meta name="keywords" content="">
   <meta name="description" content="">
   <meta name="author" content="">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous" referrerpolicy="no-referrer" />
   <!-- bootstrap css -->
   <link rel="stylesheet" type="text/css" href="./css/bootstrap.min.css">
   <!-- style css -->
   <!-- Responsive-->
   <link rel="stylesheet" href="./css/responsive.css">
   <!-- fevicon -->
   <link rel="icon" href="images/fevicon.png" type="image/gif" />
   <!-- MEDIA -->
   <link rel="stylesheet" href="./css/media.css">
   <!-- Scrollbar Custom CSS -->
   <link rel="stylesheet" type="text/css" href="./css/style.css">
   <!-- Tweaks for older IEs-->
   <link rel="shortcut icon" href="./images/it logo2.png" type="image/x-icon">
   <!-- fonts -->
   <!-- owl stylesheets -->
</head>

<body>
   <!-- header section start -->

   <!-- header section end -->
   <!-- contact section start -->
   <div class="contact_section layout_padding">
      <div class="container">
         <h1 class="contact_taital">Kirish</h1>
         <div class="email_text">
            <form action="" id="form">
               <div class="form-group">
                  <input type="tel" id="tel" class="email-bt telEl" placeholder="Tel nomer" data-format="(**) ***-**-**"
                     data-mask="(xx) xxx-xx-xx">
               </div>
               <button class="btn btn-dark px-4 py-2">Jo'natish</button>
            </form>
         </div>
      </div>
   </div>
   <div id="snackbar">Some text some message..</div>

   <!-- contact section end -->
   <!-- footer section start -->
   <div class="footer_section layout_padding">
      <div class="container">
         <div class="location_main">
            <div class="call_text"><img src="images/call-icon.png"></div>
            <div class="call_text"><a href="#">Number: +998916623961</a></div>
         </div>
         <div class="social_icon">
            <ul>
               <li><a href="https://www.facebook.com/usmonali.rustamov?mibextid=ZbWKwL"><img
                        src="./images/Facebook_Logo_(2019).png.webp"></a></li>
               <li><a href="https://instagram.com/quva_it?igshid=YmMyMTA2M2Y="><img
                        src="./images/png-clipart-logo-icon-instagram-logo-instagram-logo-purple-violet-thumbnail.png"></a>
               </li>
               <li><a href="https://t.me/it_center_quva_tumani"><img src="./images/185977.png" alt=""></a></li>
            </ul>
         </div>
      </div>
   </div>
   <!-- footer section end -->

   <script>
      let userLogin = JSON.parse(localStorage.getItem('list')) ? JSON.parse(localStorage.getItem('list')) : []

      function doFormat(x, pattern, mask) {
         var strippedValue = x.replace(/[^0-9]/g, "");
         var chars = strippedValue.split('');
         var count = 0;

         var formatted = '';
         for (var i = 0; i < pattern.length; i++) {
            const c = pattern[i];
            if (chars[count]) {
               if (/\*/.test(c)) {
                  formatted += chars[count];
                  count++;
               } else {
                  formatted += c;
               }
            } else if (mask) {
               if (mask.split('')[i])
                  formatted += mask.split('')[i];
            }
         }
         return formatted;
      }

      document.querySelectorAll('[data-mask]').forEach(function (e) {
         function format(elem) {
            const val = doFormat(elem.value, elem.getAttribute('data-format'));
            elem.value = doFormat(elem.value, elem.getAttribute('data-format'), elem.getAttribute('data-mask'));

            if (elem.createTextRange) {
               var range = elem.createTextRange();
               range.move('character', val.length);
               range.select();
            } else if (elem.selectionStart) {
               elem.focus();
               elem.setSelectionRange(val.length, val.length);
            }
         }
         e.addEventListener('keyup', function () {
            format(e);
         });
         e.addEventListener('keydown', function () {
            format(e);
         });
         format(e)
      });

      document.getElementById('form').addEventListener('submit', i => {
         i.preventDefault()
         let telN = document.getElementById('tel').value
         let formdata = new FormData();

         formdata.append("phone", telN);
         fetch("http://35.242.182.188:8080/it-conference-kuva/auth/login", {
            method: 'POST',
            body: formdata
         }).then((data, i) => {
            console.log(data);
            return data.json()
         }).then((user) => {
            console.log(user);
            let cardUserStatus = user.status
            let cardUserMessage = user.message
            
            
            if (cardUserStatus == true) {
               let cardUserId = user.data.cardID
               window.open('kirish.html', '_self')
               userLogin.push(
                  {
                     "cardUserID": cardUserId
                  }
               )
               localStorage.setItem('list', JSON.stringify(userLogin))
            } else{
               function myFunction() {
            // Get the snackbar DIV
            var x = document.getElementById("snackbar");
          
            // Add the "show" class to DIV
            x.className = "show";
          
            // After 3 seconds, remove the show class from DIV
            setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
            document.getElementById('snackbar').textContent = cardUserMessage
            document.getElementById('snackbar').style = 'color: white; background: red;'

          }
          myFunction()
            }


         })


      })

   </script>
</body>

</html>